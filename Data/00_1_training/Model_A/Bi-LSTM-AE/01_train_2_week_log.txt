
==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 1 (years: [2005, 2006])
Epoch 01 | Train loss: 0.06084 | Val loss: 0.04340 | Combo score: 0.412 | Smoothed: 0.412 | MCC: 0.217 | REC: 0.245 | PRE: 0.245 | AUC: 0.728 | Threshold: 0.11985
Epoch 02 | Train loss: 0.02470 | Val loss: 0.02330 | Combo score: 0.408 | Smoothed: 0.412 | MCC: 0.153 | REC: 0.725 | PRE: 0.075 | AUC: 0.715 | Threshold: 0.02608
Epoch 03 | Train loss: 0.01687 | Val loss: 0.02222 | Combo score: 0.391 | Smoothed: 0.410 | MCC: 0.132 | REC: 0.500 | PRE: 0.082 | AUC: 0.724 | Threshold: 0.03133
Epoch 04 | Train loss: 0.01613 | Val loss: 0.02087 | Combo score: 0.362 | Smoothed: 0.405 | MCC: 0.081 | REC: 0.461 | PRE: 0.060 | AUC: 0.621 | Threshold: 0.02611
Epoch 05 | Train loss: 0.01571 | Val loss: 0.02075 | Combo score: 0.359 | Smoothed: 0.401 | MCC: 0.076 | REC: 0.471 | PRE: 0.058 | AUC: 0.601 | Threshold: 0.02519
Epoch 06 | Train loss: 0.01560 | Val loss: 0.02057 | Combo score: 0.358 | Smoothed: 0.396 | MCC: 0.074 | REC: 0.461 | PRE: 0.057 | AUC: 0.600 | Threshold: 0.02581
Epoch 07 | Train loss: 0.01548 | Val loss: 0.02032 | Combo score: 0.353 | Smoothed: 0.392 | MCC: 0.063 | REC: 0.471 | PRE: 0.053 | AUC: 0.582 | Threshold: 0.02304
Epoch 08 | Train loss: 0.01542 | Val loss: 0.02061 | Combo score: 0.364 | Smoothed: 0.389 | MCC: 0.077 | REC: 0.549 | PRE: 0.055 | AUC: 0.609 | Threshold: 0.02121
Epoch 09 | Train loss: 0.01535 | Val loss: 0.02021 | Combo score: 0.350 | Smoothed: 0.385 | MCC: 0.062 | REC: 0.382 | PRE: 0.056 | AUC: 0.591 | Threshold: 0.02842
Epoch 10 | Train loss: 0.01530 | Val loss: 0.01983 | Combo score: 0.344 | Smoothed: 0.381 | MCC: 0.044 | REC: 0.480 | PRE: 0.046 | AUC: 0.547 | Threshold: 0.02034
Epoch 11 | Train loss: 0.01523 | Val loss: 0.02021 | Combo score: 0.359 | Smoothed: 0.379 | MCC: 0.069 | REC: 0.549 | PRE: 0.052 | AUC: 0.586 | Threshold: 0.02083
Epoch 12 | Train loss: 0.01522 | Val loss: 0.01996 | Combo score: 0.353 | Smoothed: 0.376 | MCC: 0.064 | REC: 0.461 | PRE: 0.053 | AUC: 0.582 | Threshold: 0.02319
Epoch 13 | Train loss: 0.01517 | Val loss: 0.02033 | Combo score: 0.362 | Smoothed: 0.375 | MCC: 0.077 | REC: 0.529 | PRE: 0.055 | AUC: 0.593 | Threshold: 0.02194
Epoch 14 | Train loss: 0.01514 | Val loss: 0.02039 | Combo score: 0.365 | Smoothed: 0.374 | MCC: 0.088 | REC: 0.461 | PRE: 0.063 | AUC: 0.624 | Threshold: 0.02735
Epoch 15 | Train loss: 0.01275 | Val loss: 0.01585 | Combo score: 0.394 | Smoothed: 0.376 | MCC: 0.161 | REC: 0.363 | PRE: 0.122 | AUC: 0.717 | Threshold: 0.02987
Epoch 16 | Train loss: 0.00899 | Val loss: 0.01429 | Combo score: 0.408 | Smoothed: 0.379 | MCC: 0.187 | REC: 0.451 | PRE: 0.126 | AUC: 0.729 | Threshold: 0.02436
Epoch 17 | Train loss: 0.00682 | Val loss: 0.01138 | Combo score: 0.410 | Smoothed: 0.382 | MCC: 0.193 | REC: 0.471 | PRE: 0.127 | AUC: 0.727 | Threshold: 0.02165
Epoch 18 | Train loss: 0.00586 | Val loss: 0.01121 | Combo score: 0.413 | Smoothed: 0.385 | MCC: 0.201 | REC: 0.520 | PRE: 0.125 | AUC: 0.702 | Threshold: 0.01965
Epoch 19 | Train loss: 0.00555 | Val loss: 0.01026 | Combo score: 0.422 | Smoothed: 0.389 | MCC: 0.221 | REC: 0.480 | PRE: 0.150 | AUC: 0.738 | Threshold: 0.02229
Epoch 20 | Train loss: 0.00524 | Val loss: 0.00995 | Combo score: 0.409 | Smoothed: 0.391 | MCC: 0.197 | REC: 0.373 | PRE: 0.155 | AUC: 0.735 | Threshold: 0.02487
Epoch 21 | Train loss: 0.00534 | Val loss: 0.01075 | Combo score: 0.408 | Smoothed: 0.393 | MCC: 0.192 | REC: 0.382 | PRE: 0.147 | AUC: 0.739 | Threshold: 0.02575
Epoch 22 | Train loss: 0.00515 | Val loss: 0.01011 | Combo score: 0.422 | Smoothed: 0.396 | MCC: 0.222 | REC: 0.490 | PRE: 0.148 | AUC: 0.738 | Threshold: 0.02164
Epoch 23 | Train loss: 0.00505 | Val loss: 0.01093 | Combo score: 0.416 | Smoothed: 0.398 | MCC: 0.207 | REC: 0.451 | PRE: 0.144 | AUC: 0.743 | Threshold: 0.02410
Epoch 24 | Train loss: 0.00489 | Val loss: 0.01022 | Combo score: 0.428 | Smoothed: 0.401 | MCC: 0.233 | REC: 0.461 | PRE: 0.165 | AUC: 0.767 | Threshold: 0.02561
Epoch 25 | Train loss: 0.00473 | Val loss: 0.00967 | Combo score: 0.423 | Smoothed: 0.403 | MCC: 0.226 | REC: 0.451 | PRE: 0.162 | AUC: 0.747 | Threshold: 0.02251
Epoch 26 | Train loss: 0.00454 | Val loss: 0.00976 | Combo score: 0.422 | Smoothed: 0.405 | MCC: 0.218 | REC: 0.441 | PRE: 0.157 | AUC: 0.768 | Threshold: 0.02351
Epoch 27 | Train loss: 0.00447 | Val loss: 0.00998 | Combo score: 0.413 | Smoothed: 0.406 | MCC: 0.203 | REC: 0.382 | PRE: 0.159 | AUC: 0.748 | Threshold: 0.02744
Epoch 28 | Train loss: 0.00490 | Val loss: 0.01280 | Combo score: 0.417 | Smoothed: 0.407 | MCC: 0.215 | REC: 0.422 | PRE: 0.159 | AUC: 0.738 | Threshold: 0.02889
Epoch 29 | Train loss: 0.00481 | Val loss: 0.00999 | Combo score: 0.429 | Smoothed: 0.409 | MCC: 0.233 | REC: 0.500 | PRE: 0.156 | AUC: 0.762 | Threshold: 0.02174
Epoch 30 | Train loss: 0.00445 | Val loss: 0.01048 | Combo score: 0.426 | Smoothed: 0.411 | MCC: 0.225 | REC: 0.412 | PRE: 0.173 | AUC: 0.788 | Threshold: 0.02843
Epoch 31 | Train loss: 0.00484 | Val loss: 0.01006 | Combo score: 0.424 | Smoothed: 0.412 | MCC: 0.227 | REC: 0.431 | PRE: 0.168 | AUC: 0.758 | Threshold: 0.02534
Epoch 32 | Train loss: 0.00465 | Val loss: 0.00986 | Combo score: 0.411 | Smoothed: 0.412 | MCC: 0.197 | REC: 0.373 | PRE: 0.154 | AUC: 0.762 | Threshold: 0.02715
Epoch 33 | Train loss: 0.00438 | Val loss: 0.01001 | Combo score: 0.430 | Smoothed: 0.414 | MCC: 0.236 | REC: 0.500 | PRE: 0.158 | AUC: 0.764 | Threshold: 0.02184
Epoch 34 | Train loss: 0.00419 | Val loss: 0.00961 | Combo score: 0.411 | Smoothed: 0.413 | MCC: 0.200 | REC: 0.373 | PRE: 0.158 | AUC: 0.744 | Threshold: 0.02684
Epoch 35 | Train loss: 0.00410 | Val loss: 0.00971 | Combo score: 0.409 | Smoothed: 0.413 | MCC: 0.195 | REC: 0.343 | PRE: 0.163 | AUC: 0.748 | Threshold: 0.02993
Epoch 36 | Train loss: 0.00405 | Val loss: 0.00929 | Combo score: 0.408 | Smoothed: 0.412 | MCC: 0.192 | REC: 0.373 | PRE: 0.150 | AUC: 0.741 | Threshold: 0.02570
Epoch 37 | Train loss: 0.00404 | Val loss: 0.01027 | Combo score: 0.414 | Smoothed: 0.413 | MCC: 0.205 | REC: 0.382 | PRE: 0.160 | AUC: 0.754 | Threshold: 0.02956
Epoch 38 | Train loss: 0.00407 | Val loss: 0.00885 | Combo score: 0.404 | Smoothed: 0.412 | MCC: 0.189 | REC: 0.373 | PRE: 0.147 | AUC: 0.715 | Threshold: 0.02295
Epoch 39 | Train loss: 0.00389 | Val loss: 0.00941 | Combo score: 0.412 | Smoothed: 0.412 | MCC: 0.207 | REC: 0.382 | PRE: 0.163 | AUC: 0.729 | Threshold: 0.02866
Epoch 40 | Train loss: 0.00382 | Val loss: 0.00923 | Combo score: 0.414 | Smoothed: 0.412 | MCC: 0.207 | REC: 0.373 | PRE: 0.165 | AUC: 0.750 | Threshold: 0.02930
Epoch 41 | Train loss: 0.00373 | Val loss: 0.00957 | Combo score: 0.409 | Smoothed: 0.412 | MCC: 0.199 | REC: 0.353 | PRE: 0.164 | AUC: 0.729 | Threshold: 0.03337
Epoch 42 | Train loss: 0.00379 | Val loss: 0.00921 | Combo score: 0.412 | Smoothed: 0.412 | MCC: 0.206 | REC: 0.441 | PRE: 0.146 | AUC: 0.706 | Threshold: 0.02034
Epoch 43 | Train loss: 0.00368 | Val loss: 0.00887 | Combo score: 0.421 | Smoothed: 0.413 | MCC: 0.226 | REC: 0.412 | PRE: 0.174 | AUC: 0.739 | Threshold: 0.02692
Early stopping at epoch 43 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 1 summary (years: [2005, 2006]) ---
Best epoch: 33
Threshold used: 0.02184
Validation metrics:
ACC: 88.8%
PRE: 15.8%
REC: 50.0%
MCC: 0.24
AUC: 0.76
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 2 (years: [2006, 2007])
Epoch 01 | Train loss: 0.06175 | Val loss: 0.03980 | Combo score: 0.417 | Smoothed: 0.417 | MCC: 0.231 | REC: 0.254 | PRE: 0.272 | AUC: 0.711 | Threshold: 0.09997
Epoch 02 | Train loss: 0.03100 | Val loss: 0.04021 | Combo score: 0.414 | Smoothed: 0.416 | MCC: 0.226 | REC: 0.246 | PRE: 0.270 | AUC: 0.705 | Threshold: 0.11836
Epoch 03 | Train loss: 0.02970 | Val loss: 0.03937 | Combo score: 0.417 | Smoothed: 0.417 | MCC: 0.233 | REC: 0.221 | PRE: 0.307 | AUC: 0.704 | Threshold: 0.10893
Epoch 04 | Train loss: 0.02962 | Val loss: 0.03864 | Combo score: 0.412 | Smoothed: 0.416 | MCC: 0.228 | REC: 0.221 | PRE: 0.297 | AUC: 0.676 | Threshold: 0.10818
Epoch 05 | Train loss: 0.02961 | Val loss: 0.03888 | Combo score: 0.415 | Smoothed: 0.416 | MCC: 0.229 | REC: 0.246 | PRE: 0.275 | AUC: 0.705 | Threshold: 0.10453
Epoch 06 | Train loss: 0.02948 | Val loss: 0.03935 | Combo score: 0.415 | Smoothed: 0.416 | MCC: 0.229 | REC: 0.246 | PRE: 0.275 | AUC: 0.706 | Threshold: 0.11133
Epoch 07 | Train loss: 0.02948 | Val loss: 0.03968 | Combo score: 0.421 | Smoothed: 0.416 | MCC: 0.244 | REC: 0.246 | PRE: 0.303 | AUC: 0.699 | Threshold: 0.11051
Epoch 08 | Train loss: 0.02945 | Val loss: 0.03762 | Combo score: 0.409 | Smoothed: 0.416 | MCC: 0.225 | REC: 0.246 | PRE: 0.268 | AUC: 0.661 | Threshold: 0.10232
Epoch 09 | Train loss: 0.02944 | Val loss: 0.03937 | Combo score: 0.419 | Smoothed: 0.416 | MCC: 0.241 | REC: 0.254 | PRE: 0.290 | AUC: 0.698 | Threshold: 0.10977
Epoch 10 | Train loss: 0.02783 | Val loss: 0.02366 | Combo score: 0.392 | Smoothed: 0.414 | MCC: 0.137 | REC: 0.492 | PRE: 0.095 | AUC: 0.719 | Threshold: 0.03193
Epoch 11 | Train loss: 0.01740 | Val loss: 0.02243 | Combo score: 0.423 | Smoothed: 0.415 | MCC: 0.195 | REC: 0.672 | PRE: 0.108 | AUC: 0.755 | Threshold: 0.02897
Epoch 12 | Train loss: 0.01706 | Val loss: 0.02234 | Combo score: 0.416 | Smoothed: 0.415 | MCC: 0.182 | REC: 0.607 | PRE: 0.109 | AUC: 0.753 | Threshold: 0.03010
Epoch 13 | Train loss: 0.01701 | Val loss: 0.02281 | Combo score: 0.427 | Smoothed: 0.416 | MCC: 0.201 | REC: 0.697 | PRE: 0.109 | AUC: 0.759 | Threshold: 0.02969
Epoch 14 | Train loss: 0.01697 | Val loss: 0.02177 | Combo score: 0.404 | Smoothed: 0.415 | MCC: 0.160 | REC: 0.533 | PRE: 0.104 | AUC: 0.743 | Threshold: 0.03108
Epoch 15 | Train loss: 0.01511 | Val loss: 0.01481 | Combo score: 0.385 | Smoothed: 0.412 | MCC: 0.133 | REC: 0.443 | PRE: 0.098 | AUC: 0.679 | Threshold: 0.02162
Epoch 16 | Train loss: 0.01059 | Val loss: 0.01426 | Combo score: 0.384 | Smoothed: 0.409 | MCC: 0.154 | REC: 0.328 | PRE: 0.134 | AUC: 0.645 | Threshold: 0.02897
Epoch 17 | Train loss: 0.00978 | Val loss: 0.01334 | Combo score: 0.394 | Smoothed: 0.407 | MCC: 0.158 | REC: 0.459 | PRE: 0.112 | AUC: 0.681 | Threshold: 0.02029
Epoch 18 | Train loss: 0.00915 | Val loss: 0.01313 | Combo score: 0.405 | Smoothed: 0.407 | MCC: 0.180 | REC: 0.500 | PRE: 0.122 | AUC: 0.701 | Threshold: 0.02004
Epoch 19 | Train loss: 0.00801 | Val loss: 0.01114 | Combo score: 0.415 | Smoothed: 0.408 | MCC: 0.210 | REC: 0.484 | PRE: 0.148 | AUC: 0.709 | Threshold: 0.01858
Epoch 20 | Train loss: 0.00707 | Val loss: 0.01106 | Combo score: 0.417 | Smoothed: 0.409 | MCC: 0.214 | REC: 0.467 | PRE: 0.155 | AUC: 0.721 | Threshold: 0.02027
Epoch 21 | Train loss: 0.00653 | Val loss: 0.01046 | Combo score: 0.422 | Smoothed: 0.410 | MCC: 0.227 | REC: 0.410 | PRE: 0.185 | AUC: 0.740 | Threshold: 0.02234
Epoch 22 | Train loss: 0.00610 | Val loss: 0.00995 | Combo score: 0.418 | Smoothed: 0.411 | MCC: 0.216 | REC: 0.459 | PRE: 0.160 | AUC: 0.720 | Threshold: 0.01847
Epoch 23 | Train loss: 0.00580 | Val loss: 0.00957 | Combo score: 0.430 | Smoothed: 0.413 | MCC: 0.246 | REC: 0.467 | PRE: 0.186 | AUC: 0.732 | Threshold: 0.01929
Epoch 24 | Train loss: 0.00554 | Val loss: 0.00925 | Combo score: 0.426 | Smoothed: 0.414 | MCC: 0.237 | REC: 0.434 | PRE: 0.187 | AUC: 0.744 | Threshold: 0.01892
Epoch 25 | Train loss: 0.00503 | Val loss: 0.00762 | Combo score: 0.397 | Smoothed: 0.413 | MCC: 0.147 | REC: 0.566 | PRE: 0.092 | AUC: 0.697 | Threshold: 0.00947
Epoch 26 | Train loss: 0.00440 | Val loss: 0.00677 | Combo score: 0.376 | Smoothed: 0.409 | MCC: 0.142 | REC: 0.172 | PRE: 0.183 | AUC: 0.661 | Threshold: 0.01746
Epoch 27 | Train loss: 0.00414 | Val loss: 0.00679 | Combo score: 0.368 | Smoothed: 0.405 | MCC: 0.122 | REC: 0.189 | PRE: 0.144 | AUC: 0.652 | Threshold: 0.01657
Epoch 28 | Train loss: 0.00396 | Val loss: 0.00656 | Combo score: 0.356 | Smoothed: 0.400 | MCC: 0.095 | REC: 0.189 | PRE: 0.111 | AUC: 0.624 | Threshold: 0.01401
Epoch 29 | Train loss: 0.00358 | Val loss: 0.00606 | Combo score: 0.343 | Smoothed: 0.394 | MCC: 0.062 | REC: 0.197 | PRE: 0.079 | AUC: 0.607 | Threshold: 0.01172
Epoch 30 | Train loss: 0.00341 | Val loss: 0.00569 | Combo score: 0.347 | Smoothed: 0.390 | MCC: 0.067 | REC: 0.246 | PRE: 0.077 | AUC: 0.606 | Threshold: 0.01033
Epoch 31 | Train loss: 0.00330 | Val loss: 0.00554 | Combo score: 0.337 | Smoothed: 0.384 | MCC: 0.054 | REC: 0.172 | PRE: 0.076 | AUC: 0.580 | Threshold: 0.01101
Epoch 32 | Train loss: 0.00320 | Val loss: 0.00537 | Combo score: 0.345 | Smoothed: 0.380 | MCC: 0.070 | REC: 0.156 | PRE: 0.094 | AUC: 0.612 | Threshold: 0.01183
Epoch 33 | Train loss: 0.00308 | Val loss: 0.00538 | Combo score: 0.357 | Smoothed: 0.378 | MCC: 0.084 | REC: 0.336 | PRE: 0.079 | AUC: 0.610 | Threshold: 0.00849
Epoch 34 | Train loss: 0.00297 | Val loss: 0.00524 | Combo score: 0.359 | Smoothed: 0.376 | MCC: 0.088 | REC: 0.352 | PRE: 0.079 | AUC: 0.607 | Threshold: 0.00806
Early stopping at epoch 34 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 2 summary (years: [2006, 2007]) ---
Best epoch: 23
Threshold used: 0.01929
Validation metrics:
ACC: 89.0%
PRE: 18.6%
REC: 46.7%
MCC: 0.25
AUC: 0.73
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 3 (years: [2007, 2008])
Epoch 01 | Train loss: 0.06533 | Val loss: 0.04071 | Combo score: 0.375 | Smoothed: 0.375 | MCC: 0.129 | REC: 0.158 | PRE: 0.158 | AUC: 0.706 | Threshold: 0.11318
Epoch 02 | Train loss: 0.02356 | Val loss: 0.02079 | Combo score: 0.394 | Smoothed: 0.377 | MCC: 0.163 | REC: 0.253 | PRE: 0.156 | AUC: 0.748 | Threshold: 0.04020
Epoch 03 | Train loss: 0.02176 | Val loss: 0.01909 | Combo score: 0.393 | Smoothed: 0.379 | MCC: 0.157 | REC: 0.242 | PRE: 0.152 | AUC: 0.763 | Threshold: 0.03933
Epoch 04 | Train loss: 0.01645 | Val loss: 0.01593 | Combo score: 0.425 | Smoothed: 0.383 | MCC: 0.220 | REC: 0.389 | PRE: 0.171 | AUC: 0.808 | Threshold: 0.03177
Epoch 05 | Train loss: 0.01322 | Val loss: 0.01448 | Combo score: 0.438 | Smoothed: 0.389 | MCC: 0.234 | REC: 0.568 | PRE: 0.139 | AUC: 0.828 | Threshold: 0.02612
Epoch 06 | Train loss: 0.01181 | Val loss: 0.01239 | Combo score: 0.443 | Smoothed: 0.394 | MCC: 0.259 | REC: 0.432 | PRE: 0.200 | AUC: 0.841 | Threshold: 0.02711
Epoch 07 | Train loss: 0.01155 | Val loss: 0.01233 | Combo score: 0.419 | Smoothed: 0.397 | MCC: 0.203 | REC: 0.400 | PRE: 0.150 | AUC: 0.806 | Threshold: 0.02470
Epoch 08 | Train loss: 0.01114 | Val loss: 0.01227 | Combo score: 0.429 | Smoothed: 0.400 | MCC: 0.223 | REC: 0.389 | PRE: 0.175 | AUC: 0.837 | Threshold: 0.02637
Epoch 09 | Train loss: 0.01087 | Val loss: 0.01193 | Combo score: 0.418 | Smoothed: 0.402 | MCC: 0.204 | REC: 0.379 | PRE: 0.157 | AUC: 0.803 | Threshold: 0.02715
Epoch 10 | Train loss: 0.01073 | Val loss: 0.01127 | Combo score: 0.414 | Smoothed: 0.403 | MCC: 0.202 | REC: 0.379 | PRE: 0.155 | AUC: 0.771 | Threshold: 0.02477
Epoch 11 | Train loss: 0.01043 | Val loss: 0.01087 | Combo score: 0.416 | Smoothed: 0.404 | MCC: 0.208 | REC: 0.389 | PRE: 0.157 | AUC: 0.768 | Threshold: 0.02414
Epoch 12 | Train loss: 0.01029 | Val loss: 0.01159 | Combo score: 0.416 | Smoothed: 0.406 | MCC: 0.208 | REC: 0.368 | PRE: 0.165 | AUC: 0.773 | Threshold: 0.02828
Epoch 13 | Train loss: 0.01012 | Val loss: 0.01119 | Combo score: 0.412 | Smoothed: 0.406 | MCC: 0.203 | REC: 0.326 | PRE: 0.174 | AUC: 0.757 | Threshold: 0.02785
Epoch 14 | Train loss: 0.01067 | Val loss: 0.01100 | Combo score: 0.418 | Smoothed: 0.407 | MCC: 0.208 | REC: 0.368 | PRE: 0.165 | AUC: 0.791 | Threshold: 0.02525
Epoch 15 | Train loss: 0.00998 | Val loss: 0.01088 | Combo score: 0.410 | Smoothed: 0.408 | MCC: 0.197 | REC: 0.379 | PRE: 0.149 | AUC: 0.747 | Threshold: 0.02483
Epoch 16 | Train loss: 0.00977 | Val loss: 0.01096 | Combo score: 0.412 | Smoothed: 0.408 | MCC: 0.209 | REC: 0.337 | PRE: 0.178 | AUC: 0.739 | Threshold: 0.02863
Epoch 17 | Train loss: 0.00957 | Val loss: 0.01116 | Combo score: 0.409 | Smoothed: 0.408 | MCC: 0.202 | REC: 0.337 | PRE: 0.169 | AUC: 0.731 | Threshold: 0.02724
Epoch 18 | Train loss: 0.00942 | Val loss: 0.01086 | Combo score: 0.413 | Smoothed: 0.409 | MCC: 0.208 | REC: 0.337 | PRE: 0.177 | AUC: 0.745 | Threshold: 0.02908
Epoch 19 | Train loss: 0.00923 | Val loss: 0.01060 | Combo score: 0.415 | Smoothed: 0.409 | MCC: 0.214 | REC: 0.379 | PRE: 0.167 | AUC: 0.733 | Threshold: 0.02638
Epoch 20 | Train loss: 0.00903 | Val loss: 0.01044 | Combo score: 0.411 | Smoothed: 0.409 | MCC: 0.205 | REC: 0.347 | PRE: 0.168 | AUC: 0.741 | Threshold: 0.02779
Epoch 21 | Train loss: 0.00891 | Val loss: 0.01042 | Combo score: 0.412 | Smoothed: 0.410 | MCC: 0.208 | REC: 0.347 | PRE: 0.173 | AUC: 0.732 | Threshold: 0.02729
Epoch 22 | Train loss: 0.00933 | Val loss: 0.01060 | Combo score: 0.411 | Smoothed: 0.410 | MCC: 0.205 | REC: 0.326 | PRE: 0.177 | AUC: 0.746 | Threshold: 0.02898
Epoch 23 | Train loss: 0.00864 | Val loss: 0.00926 | Combo score: 0.410 | Smoothed: 0.410 | MCC: 0.194 | REC: 0.389 | PRE: 0.144 | AUC: 0.747 | Threshold: 0.02171
Epoch 24 | Train loss: 0.00814 | Val loss: 0.00794 | Combo score: 0.350 | Smoothed: 0.404 | MCC: 0.078 | REC: 0.126 | PRE: 0.100 | AUC: 0.649 | Threshold: 0.01872
Epoch 25 | Train loss: 0.00782 | Val loss: 0.00760 | Combo score: 0.342 | Smoothed: 0.398 | MCC: 0.061 | REC: 0.105 | PRE: 0.087 | AUC: 0.642 | Threshold: 0.02153
Epoch 26 | Train loss: 0.00767 | Val loss: 0.00736 | Combo score: 0.337 | Smoothed: 0.392 | MCC: 0.060 | REC: 0.147 | PRE: 0.074 | AUC: 0.579 | Threshold: 0.01591
Epoch 27 | Train loss: 0.00671 | Val loss: 0.00632 | Combo score: 0.350 | Smoothed: 0.387 | MCC: 0.092 | REC: 0.126 | PRE: 0.120 | AUC: 0.597 | Threshold: 0.01554
Epoch 28 | Train loss: 0.00544 | Val loss: 0.00521 | Combo score: 0.336 | Smoothed: 0.382 | MCC: 0.061 | REC: 0.053 | PRE: 0.125 | AUC: 0.592 | Threshold: 0.01526
Epoch 29 | Train loss: 0.00497 | Val loss: 0.00500 | Combo score: 0.341 | Smoothed: 0.378 | MCC: 0.054 | REC: 0.200 | PRE: 0.061 | AUC: 0.617 | Threshold: 0.00918
Epoch 30 | Train loss: 0.00456 | Val loss: 0.00497 | Combo score: 0.370 | Smoothed: 0.377 | MCC: 0.069 | REC: 0.726 | PRE: 0.044 | AUC: 0.609 | Threshold: 0.00384
Epoch 31 | Train loss: 0.00441 | Val loss: 0.00477 | Combo score: 0.333 | Smoothed: 0.373 | MCC: 0.038 | REC: 0.221 | PRE: 0.049 | AUC: 0.586 | Threshold: 0.00767
Epoch 32 | Train loss: 0.00438 | Val loss: 0.00526 | Combo score: 0.376 | Smoothed: 0.373 | MCC: 0.096 | REC: 0.568 | PRE: 0.058 | AUC: 0.657 | Threshold: 0.00602
Early stopping at epoch 32 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 3 summary (years: [2007, 2008]) ---
Best epoch: 6
Threshold used: 0.02711
Validation metrics:
ACC: 92.4%
PRE: 20.0%
REC: 43.2%
MCC: 0.26
AUC: 0.84
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 4 (years: [2008, 2009])
Epoch 01 | Train loss: 0.06545 | Val loss: 0.05084 | Combo score: 0.508 | Smoothed: 0.508 | MCC: 0.417 | REC: 0.493 | PRE: 0.405 | AUC: 0.884 | Threshold: 0.10727
Epoch 02 | Train loss: 0.02476 | Val loss: 0.01685 | Combo score: 0.487 | Smoothed: 0.506 | MCC: 0.382 | REC: 0.396 | PRE: 0.424 | AUC: 0.818 | Threshold: 0.03575
Epoch 03 | Train loss: 0.01400 | Val loss: 0.01351 | Combo score: 0.490 | Smoothed: 0.505 | MCC: 0.374 | REC: 0.276 | PRE: 0.561 | AUC: 0.861 | Threshold: 0.03479
Epoch 04 | Train loss: 0.01344 | Val loss: 0.01270 | Combo score: 0.495 | Smoothed: 0.504 | MCC: 0.387 | REC: 0.261 | PRE: 0.625 | AUC: 0.850 | Threshold: 0.03537
Epoch 05 | Train loss: 0.01123 | Val loss: 0.01195 | Combo score: 0.456 | Smoothed: 0.499 | MCC: 0.300 | REC: 0.425 | PRE: 0.273 | AUC: 0.815 | Threshold: 0.02770
Epoch 06 | Train loss: 0.01076 | Val loss: 0.01165 | Combo score: 0.466 | Smoothed: 0.496 | MCC: 0.330 | REC: 0.313 | PRE: 0.408 | AUC: 0.810 | Threshold: 0.03066
Epoch 07 | Train loss: 0.01070 | Val loss: 0.01142 | Combo score: 0.475 | Smoothed: 0.494 | MCC: 0.344 | REC: 0.306 | PRE: 0.446 | AUC: 0.838 | Threshold: 0.03211
Epoch 08 | Train loss: 0.00982 | Val loss: 0.01101 | Combo score: 0.472 | Smoothed: 0.491 | MCC: 0.333 | REC: 0.478 | PRE: 0.290 | AUC: 0.844 | Threshold: 0.02892
Epoch 09 | Train loss: 0.00932 | Val loss: 0.01023 | Combo score: 0.460 | Smoothed: 0.488 | MCC: 0.313 | REC: 0.455 | PRE: 0.275 | AUC: 0.796 | Threshold: 0.02603
Epoch 10 | Train loss: 0.00880 | Val loss: 0.00982 | Combo score: 0.473 | Smoothed: 0.487 | MCC: 0.345 | REC: 0.463 | PRE: 0.315 | AUC: 0.807 | Threshold: 0.02492
Epoch 11 | Train loss: 0.00844 | Val loss: 0.00922 | Combo score: 0.472 | Smoothed: 0.485 | MCC: 0.342 | REC: 0.500 | PRE: 0.291 | AUC: 0.796 | Threshold: 0.02226
Epoch 12 | Train loss: 0.00793 | Val loss: 0.00871 | Combo score: 0.460 | Smoothed: 0.483 | MCC: 0.319 | REC: 0.440 | PRE: 0.291 | AUC: 0.776 | Threshold: 0.02233
Epoch 13 | Train loss: 0.00761 | Val loss: 0.00811 | Combo score: 0.473 | Smoothed: 0.482 | MCC: 0.344 | REC: 0.485 | PRE: 0.301 | AUC: 0.806 | Threshold: 0.02191
Epoch 14 | Train loss: 0.00711 | Val loss: 0.00726 | Combo score: 0.468 | Smoothed: 0.480 | MCC: 0.336 | REC: 0.448 | PRE: 0.311 | AUC: 0.791 | Threshold: 0.02125
Epoch 15 | Train loss: 0.00673 | Val loss: 0.00723 | Combo score: 0.468 | Smoothed: 0.479 | MCC: 0.335 | REC: 0.507 | PRE: 0.279 | AUC: 0.778 | Threshold: 0.02038
Epoch 16 | Train loss: 0.00639 | Val loss: 0.00790 | Combo score: 0.463 | Smoothed: 0.478 | MCC: 0.322 | REC: 0.418 | PRE: 0.308 | AUC: 0.805 | Threshold: 0.02798
Epoch 17 | Train loss: 0.00636 | Val loss: 0.00735 | Combo score: 0.471 | Smoothed: 0.477 | MCC: 0.342 | REC: 0.478 | PRE: 0.302 | AUC: 0.793 | Threshold: 0.02329
Epoch 18 | Train loss: 0.00589 | Val loss: 0.00679 | Combo score: 0.465 | Smoothed: 0.476 | MCC: 0.325 | REC: 0.440 | PRE: 0.299 | AUC: 0.804 | Threshold: 0.02293
Epoch 19 | Train loss: 0.00564 | Val loss: 0.00653 | Combo score: 0.472 | Smoothed: 0.475 | MCC: 0.341 | REC: 0.500 | PRE: 0.290 | AUC: 0.800 | Threshold: 0.01926
Epoch 20 | Train loss: 0.00617 | Val loss: 0.00725 | Combo score: 0.474 | Smoothed: 0.475 | MCC: 0.341 | REC: 0.478 | PRE: 0.300 | AUC: 0.826 | Threshold: 0.02207
Epoch 21 | Train loss: 0.00592 | Val loss: 0.00697 | Combo score: 0.466 | Smoothed: 0.474 | MCC: 0.329 | REC: 0.440 | PRE: 0.304 | AUC: 0.801 | Threshold: 0.02326
Epoch 22 | Train loss: 0.00545 | Val loss: 0.00729 | Combo score: 0.476 | Smoothed: 0.474 | MCC: 0.340 | REC: 0.619 | PRE: 0.241 | AUC: 0.811 | Threshold: 0.01846
Epoch 23 | Train loss: 0.00515 | Val loss: 0.00656 | Combo score: 0.466 | Smoothed: 0.474 | MCC: 0.329 | REC: 0.440 | PRE: 0.304 | AUC: 0.804 | Threshold: 0.02259
Epoch 24 | Train loss: 0.00500 | Val loss: 0.00678 | Combo score: 0.474 | Smoothed: 0.474 | MCC: 0.341 | REC: 0.493 | PRE: 0.293 | AUC: 0.822 | Threshold: 0.02266
Early stopping at epoch 24 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 4 summary (years: [2008, 2009]) ---
Best epoch: 1
Threshold used: 0.10727
Validation metrics:
ACC: 94.2%
PRE: 40.5%
REC: 49.3%
MCC: 0.42
AUC: 0.88
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 5 (years: [2009, 2010])
Epoch 01 | Train loss: 0.06489 | Val loss: 0.03489 | Combo score: 0.483 | Smoothed: 0.483 | MCC: 0.373 | REC: 0.298 | PRE: 0.541 | AUC: 0.795 | Threshold: 0.09843
Epoch 02 | Train loss: 0.02668 | Val loss: 0.01852 | Combo score: 0.454 | Smoothed: 0.480 | MCC: 0.295 | REC: 0.180 | PRE: 0.561 | AUC: 0.785 | Threshold: 0.05259
Epoch 03 | Train loss: 0.01860 | Val loss: 0.01806 | Combo score: 0.442 | Smoothed: 0.477 | MCC: 0.246 | REC: 0.635 | PRE: 0.170 | AUC: 0.776 | Threshold: 0.02194
Epoch 04 | Train loss: 0.01825 | Val loss: 0.01871 | Combo score: 0.464 | Smoothed: 0.475 | MCC: 0.301 | REC: 0.618 | PRE: 0.220 | AUC: 0.821 | Threshold: 0.02912
Epoch 05 | Train loss: 0.01819 | Val loss: 0.01790 | Combo score: 0.452 | Smoothed: 0.473 | MCC: 0.270 | REC: 0.640 | PRE: 0.188 | AUC: 0.790 | Threshold: 0.02336
Epoch 06 | Train loss: 0.01797 | Val loss: 0.01824 | Combo score: 0.457 | Smoothed: 0.471 | MCC: 0.281 | REC: 0.635 | PRE: 0.198 | AUC: 0.810 | Threshold: 0.02509
Epoch 07 | Train loss: 0.01789 | Val loss: 0.01810 | Combo score: 0.455 | Smoothed: 0.470 | MCC: 0.275 | REC: 0.646 | PRE: 0.191 | AUC: 0.808 | Threshold: 0.02449
Epoch 08 | Train loss: 0.01783 | Val loss: 0.01786 | Combo score: 0.452 | Smoothed: 0.468 | MCC: 0.267 | REC: 0.652 | PRE: 0.183 | AUC: 0.797 | Threshold: 0.02318
Epoch 09 | Train loss: 0.01779 | Val loss: 0.01786 | Combo score: 0.459 | Smoothed: 0.467 | MCC: 0.287 | REC: 0.646 | PRE: 0.201 | AUC: 0.802 | Threshold: 0.02420
Epoch 10 | Train loss: 0.01781 | Val loss: 0.01800 | Combo score: 0.450 | Smoothed: 0.465 | MCC: 0.267 | REC: 0.646 | PRE: 0.185 | AUC: 0.787 | Threshold: 0.02331
Epoch 11 | Train loss: 0.01777 | Val loss: 0.01829 | Combo score: 0.458 | Smoothed: 0.465 | MCC: 0.285 | REC: 0.635 | PRE: 0.201 | AUC: 0.810 | Threshold: 0.02531
Epoch 12 | Train loss: 0.01777 | Val loss: 0.01852 | Combo score: 0.458 | Smoothed: 0.464 | MCC: 0.282 | REC: 0.652 | PRE: 0.195 | AUC: 0.814 | Threshold: 0.02579
Epoch 13 | Train loss: 0.01776 | Val loss: 0.01849 | Combo score: 0.460 | Smoothed: 0.464 | MCC: 0.287 | REC: 0.640 | PRE: 0.202 | AUC: 0.820 | Threshold: 0.02641
Epoch 14 | Train loss: 0.01503 | Val loss: 0.01705 | Combo score: 0.497 | Smoothed: 0.467 | MCC: 0.376 | REC: 0.607 | PRE: 0.303 | AUC: 0.884 | Threshold: 0.03330
Epoch 15 | Train loss: 0.01431 | Val loss: 0.01558 | Combo score: 0.479 | Smoothed: 0.468 | MCC: 0.335 | REC: 0.635 | PRE: 0.248 | AUC: 0.841 | Threshold: 0.02495
Epoch 16 | Train loss: 0.01429 | Val loss: 0.01611 | Combo score: 0.494 | Smoothed: 0.471 | MCC: 0.371 | REC: 0.618 | PRE: 0.293 | AUC: 0.867 | Threshold: 0.02916
Epoch 17 | Train loss: 0.01426 | Val loss: 0.01556 | Combo score: 0.486 | Smoothed: 0.472 | MCC: 0.354 | REC: 0.652 | PRE: 0.262 | AUC: 0.841 | Threshold: 0.02481
Epoch 18 | Train loss: 0.01556 | Val loss: 0.01704 | Combo score: 0.432 | Smoothed: 0.468 | MCC: 0.230 | REC: 0.517 | PRE: 0.183 | AUC: 0.780 | Threshold: 0.02605
Epoch 19 | Train loss: 0.01671 | Val loss: 0.01608 | Combo score: 0.423 | Smoothed: 0.464 | MCC: 0.224 | REC: 0.506 | PRE: 0.180 | AUC: 0.720 | Threshold: 0.02421
Epoch 20 | Train loss: 0.01529 | Val loss: 0.01564 | Combo score: 0.517 | Smoothed: 0.469 | MCC: 0.428 | REC: 0.601 | PRE: 0.372 | AUC: 0.895 | Threshold: 0.03222
Epoch 21 | Train loss: 0.01161 | Val loss: 0.01212 | Combo score: 0.485 | Smoothed: 0.471 | MCC: 0.364 | REC: 0.494 | PRE: 0.342 | AUC: 0.835 | Threshold: 0.02545
Epoch 22 | Train loss: 0.01054 | Val loss: 0.01150 | Combo score: 0.484 | Smoothed: 0.472 | MCC: 0.363 | REC: 0.483 | PRE: 0.347 | AUC: 0.833 | Threshold: 0.02525
Epoch 23 | Train loss: 0.01021 | Val loss: 0.01111 | Combo score: 0.496 | Smoothed: 0.474 | MCC: 0.397 | REC: 0.489 | PRE: 0.394 | AUC: 0.824 | Threshold: 0.02551
Epoch 24 | Train loss: 0.00988 | Val loss: 0.01062 | Combo score: 0.493 | Smoothed: 0.476 | MCC: 0.392 | REC: 0.494 | PRE: 0.383 | AUC: 0.810 | Threshold: 0.02377
Epoch 25 | Train loss: 0.00948 | Val loss: 0.00986 | Combo score: 0.489 | Smoothed: 0.477 | MCC: 0.380 | REC: 0.466 | PRE: 0.382 | AUC: 0.826 | Threshold: 0.02427
Epoch 26 | Train loss: 0.00829 | Val loss: 0.00884 | Combo score: 0.505 | Smoothed: 0.480 | MCC: 0.421 | REC: 0.511 | PRE: 0.416 | AUC: 0.825 | Threshold: 0.02416
Epoch 27 | Train loss: 0.00742 | Val loss: 0.00816 | Combo score: 0.507 | Smoothed: 0.483 | MCC: 0.425 | REC: 0.461 | PRE: 0.461 | AUC: 0.830 | Threshold: 0.02479
Epoch 28 | Train loss: 0.00689 | Val loss: 0.00774 | Combo score: 0.507 | Smoothed: 0.485 | MCC: 0.426 | REC: 0.455 | PRE: 0.468 | AUC: 0.833 | Threshold: 0.02417
Epoch 29 | Train loss: 0.00639 | Val loss: 0.00771 | Combo score: 0.511 | Smoothed: 0.488 | MCC: 0.434 | REC: 0.466 | PRE: 0.472 | AUC: 0.843 | Threshold: 0.02575
Epoch 30 | Train loss: 0.00613 | Val loss: 0.00731 | Combo score: 0.507 | Smoothed: 0.490 | MCC: 0.426 | REC: 0.506 | PRE: 0.427 | AUC: 0.831 | Threshold: 0.02258
Epoch 31 | Train loss: 0.00592 | Val loss: 0.00722 | Combo score: 0.509 | Smoothed: 0.492 | MCC: 0.429 | REC: 0.517 | PRE: 0.424 | AUC: 0.833 | Threshold: 0.02232
Epoch 32 | Train loss: 0.00575 | Val loss: 0.00728 | Combo score: 0.510 | Smoothed: 0.494 | MCC: 0.426 | REC: 0.562 | PRE: 0.391 | AUC: 0.847 | Threshold: 0.02180
Epoch 33 | Train loss: 0.00553 | Val loss: 0.00707 | Combo score: 0.509 | Smoothed: 0.495 | MCC: 0.425 | REC: 0.511 | PRE: 0.421 | AUC: 0.851 | Threshold: 0.02313
Epoch 34 | Train loss: 0.00532 | Val loss: 0.00688 | Combo score: 0.506 | Smoothed: 0.496 | MCC: 0.419 | REC: 0.506 | PRE: 0.417 | AUC: 0.844 | Threshold: 0.02254
Epoch 35 | Train loss: 0.00513 | Val loss: 0.00645 | Combo score: 0.506 | Smoothed: 0.497 | MCC: 0.417 | REC: 0.449 | PRE: 0.457 | AUC: 0.859 | Threshold: 0.02285
Epoch 36 | Train loss: 0.00517 | Val loss: 0.00679 | Combo score: 0.505 | Smoothed: 0.498 | MCC: 0.413 | REC: 0.489 | PRE: 0.418 | AUC: 0.858 | Threshold: 0.02373
Epoch 37 | Train loss: 0.00504 | Val loss: 0.00645 | Combo score: 0.507 | Smoothed: 0.499 | MCC: 0.416 | REC: 0.506 | PRE: 0.411 | AUC: 0.863 | Threshold: 0.02131
Epoch 38 | Train loss: 0.00481 | Val loss: 0.00661 | Combo score: 0.503 | Smoothed: 0.499 | MCC: 0.410 | REC: 0.506 | PRE: 0.402 | AUC: 0.847 | Threshold: 0.02179
Epoch 39 | Train loss: 0.00462 | Val loss: 0.00620 | Combo score: 0.501 | Smoothed: 0.499 | MCC: 0.405 | REC: 0.539 | PRE: 0.374 | AUC: 0.837 | Threshold: 0.01970
Epoch 40 | Train loss: 0.00443 | Val loss: 0.00643 | Combo score: 0.495 | Smoothed: 0.499 | MCC: 0.394 | REC: 0.534 | PRE: 0.361 | AUC: 0.824 | Threshold: 0.01955
Epoch 41 | Train loss: 0.00431 | Val loss: 0.00600 | Combo score: 0.500 | Smoothed: 0.499 | MCC: 0.404 | REC: 0.551 | PRE: 0.366 | AUC: 0.829 | Threshold: 0.01741
Epoch 42 | Train loss: 0.00418 | Val loss: 0.00609 | Combo score: 0.500 | Smoothed: 0.499 | MCC: 0.401 | REC: 0.551 | PRE: 0.362 | AUC: 0.837 | Threshold: 0.01778
Epoch 43 | Train loss: 0.00406 | Val loss: 0.00624 | Combo score: 0.500 | Smoothed: 0.499 | MCC: 0.397 | REC: 0.506 | PRE: 0.383 | AUC: 0.868 | Threshold: 0.02157
Epoch 44 | Train loss: 0.00401 | Val loss: 0.00600 | Combo score: 0.493 | Smoothed: 0.499 | MCC: 0.389 | REC: 0.455 | PRE: 0.405 | AUC: 0.831 | Threshold: 0.02357
Epoch 45 | Train loss: 0.00385 | Val loss: 0.00584 | Combo score: 0.492 | Smoothed: 0.498 | MCC: 0.385 | REC: 0.455 | PRE: 0.399 | AUC: 0.838 | Threshold: 0.02118
Epoch 46 | Train loss: 0.00377 | Val loss: 0.00565 | Combo score: 0.501 | Smoothed: 0.498 | MCC: 0.403 | REC: 0.624 | PRE: 0.327 | AUC: 0.832 | Threshold: 0.01283
Epoch 47 | Train loss: 0.00408 | Val loss: 0.00560 | Combo score: 0.500 | Smoothed: 0.499 | MCC: 0.403 | REC: 0.562 | PRE: 0.358 | AUC: 0.834 | Threshold: 0.01452
Epoch 48 | Train loss: 0.00372 | Val loss: 0.00539 | Combo score: 0.496 | Smoothed: 0.498 | MCC: 0.392 | REC: 0.573 | PRE: 0.338 | AUC: 0.829 | Threshold: 0.01370
Epoch 49 | Train loss: 0.00358 | Val loss: 0.00581 | Combo score: 0.500 | Smoothed: 0.499 | MCC: 0.401 | REC: 0.551 | PRE: 0.362 | AUC: 0.843 | Threshold: 0.01729
Early stopping at epoch 49 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 5 summary (years: [2009, 2010]) ---
Best epoch: 20
Threshold used: 0.03222
Validation metrics:
ACC: 91.2%
PRE: 37.2%
REC: 60.1%
MCC: 0.43
AUC: 0.89
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 6 (years: [2010, 2011])
Epoch 01 | Train loss: 0.06562 | Val loss: 0.03156 | Combo score: 0.482 | Smoothed: 0.482 | MCC: 0.357 | REC: 0.382 | PRE: 0.391 | AUC: 0.863 | Threshold: 0.07396
Epoch 02 | Train loss: 0.02690 | Val loss: 0.02950 | Combo score: 0.487 | Smoothed: 0.483 | MCC: 0.368 | REC: 0.382 | PRE: 0.410 | AUC: 0.874 | Threshold: 0.06971
Epoch 03 | Train loss: 0.02591 | Val loss: 0.02908 | Combo score: 0.483 | Smoothed: 0.483 | MCC: 0.360 | REC: 0.382 | PRE: 0.397 | AUC: 0.863 | Threshold: 0.06947
Epoch 04 | Train loss: 0.02573 | Val loss: 0.02853 | Combo score: 0.487 | Smoothed: 0.483 | MCC: 0.368 | REC: 0.382 | PRE: 0.410 | AUC: 0.872 | Threshold: 0.06640
Epoch 05 | Train loss: 0.02361 | Val loss: 0.02782 | Combo score: 0.488 | Smoothed: 0.484 | MCC: 0.368 | REC: 0.382 | PRE: 0.410 | AUC: 0.877 | Threshold: 0.06759
Epoch 06 | Train loss: 0.02144 | Val loss: 0.02603 | Combo score: 0.487 | Smoothed: 0.484 | MCC: 0.363 | REC: 0.389 | PRE: 0.395 | AUC: 0.884 | Threshold: 0.06967
Epoch 07 | Train loss: 0.01979 | Val loss: 0.02693 | Combo score: 0.490 | Smoothed: 0.484 | MCC: 0.370 | REC: 0.374 | PRE: 0.422 | AUC: 0.891 | Threshold: 0.07522
Epoch 08 | Train loss: 0.01961 | Val loss: 0.02570 | Combo score: 0.488 | Smoothed: 0.485 | MCC: 0.368 | REC: 0.382 | PRE: 0.410 | AUC: 0.884 | Threshold: 0.06648
Epoch 09 | Train loss: 0.01929 | Val loss: 0.02573 | Combo score: 0.439 | Smoothed: 0.480 | MCC: 0.244 | REC: 0.458 | PRE: 0.190 | AUC: 0.839 | Threshold: 0.05315
Epoch 10 | Train loss: 0.01914 | Val loss: 0.02533 | Combo score: 0.491 | Smoothed: 0.481 | MCC: 0.373 | REC: 0.382 | PRE: 0.420 | AUC: 0.886 | Threshold: 0.07103
Epoch 11 | Train loss: 0.01902 | Val loss: 0.02553 | Combo score: 0.491 | Smoothed: 0.482 | MCC: 0.373 | REC: 0.382 | PRE: 0.420 | AUC: 0.885 | Threshold: 0.07193
Epoch 12 | Train loss: 0.01889 | Val loss: 0.02649 | Combo score: 0.490 | Smoothed: 0.483 | MCC: 0.369 | REC: 0.382 | PRE: 0.413 | AUC: 0.890 | Threshold: 0.07444
Epoch 13 | Train loss: 0.01877 | Val loss: 0.02611 | Combo score: 0.486 | Smoothed: 0.483 | MCC: 0.363 | REC: 0.389 | PRE: 0.395 | AUC: 0.877 | Threshold: 0.06575
Epoch 14 | Train loss: 0.01856 | Val loss: 0.02543 | Combo score: 0.489 | Smoothed: 0.484 | MCC: 0.369 | REC: 0.382 | PRE: 0.413 | AUC: 0.884 | Threshold: 0.06913
Epoch 15 | Train loss: 0.01842 | Val loss: 0.02443 | Combo score: 0.486 | Smoothed: 0.484 | MCC: 0.365 | REC: 0.374 | PRE: 0.412 | AUC: 0.870 | Threshold: 0.06152
Epoch 16 | Train loss: 0.01817 | Val loss: 0.02503 | Combo score: 0.489 | Smoothed: 0.485 | MCC: 0.369 | REC: 0.382 | PRE: 0.413 | AUC: 0.883 | Threshold: 0.06584
Epoch 17 | Train loss: 0.01664 | Val loss: 0.02557 | Combo score: 0.487 | Smoothed: 0.485 | MCC: 0.366 | REC: 0.382 | PRE: 0.407 | AUC: 0.877 | Threshold: 0.07024
Epoch 18 | Train loss: 0.01790 | Val loss: 0.02504 | Combo score: 0.490 | Smoothed: 0.485 | MCC: 0.371 | REC: 0.382 | PRE: 0.417 | AUC: 0.891 | Threshold: 0.06890
Epoch 19 | Train loss: 0.01774 | Val loss: 0.02476 | Combo score: 0.486 | Smoothed: 0.485 | MCC: 0.364 | REC: 0.382 | PRE: 0.403 | AUC: 0.875 | Threshold: 0.06413
Epoch 20 | Train loss: 0.01755 | Val loss: 0.02413 | Combo score: 0.488 | Smoothed: 0.486 | MCC: 0.368 | REC: 0.382 | PRE: 0.410 | AUC: 0.885 | Threshold: 0.06646
Epoch 21 | Train loss: 0.01744 | Val loss: 0.02524 | Combo score: 0.489 | Smoothed: 0.486 | MCC: 0.370 | REC: 0.374 | PRE: 0.422 | AUC: 0.884 | Threshold: 0.06657
Epoch 22 | Train loss: 0.01188 | Val loss: 0.01241 | Combo score: 0.493 | Smoothed: 0.487 | MCC: 0.376 | REC: 0.595 | PRE: 0.290 | AUC: 0.854 | Threshold: 0.02305
Epoch 23 | Train loss: 0.00910 | Val loss: 0.01093 | Combo score: 0.483 | Smoothed: 0.486 | MCC: 0.362 | REC: 0.489 | PRE: 0.323 | AUC: 0.842 | Threshold: 0.02283
Epoch 24 | Train loss: 0.00854 | Val loss: 0.01093 | Combo score: 0.489 | Smoothed: 0.487 | MCC: 0.380 | REC: 0.458 | PRE: 0.370 | AUC: 0.839 | Threshold: 0.02443
Epoch 25 | Train loss: 0.00837 | Val loss: 0.01139 | Combo score: 0.496 | Smoothed: 0.488 | MCC: 0.400 | REC: 0.443 | PRE: 0.414 | AUC: 0.835 | Threshold: 0.02619
Epoch 26 | Train loss: 0.00863 | Val loss: 0.00987 | Combo score: 0.491 | Smoothed: 0.488 | MCC: 0.387 | REC: 0.443 | PRE: 0.392 | AUC: 0.831 | Threshold: 0.02272
Epoch 27 | Train loss: 0.00694 | Val loss: 0.00911 | Combo score: 0.477 | Smoothed: 0.487 | MCC: 0.351 | REC: 0.489 | PRE: 0.308 | AUC: 0.822 | Threshold: 0.02174
Epoch 28 | Train loss: 0.00625 | Val loss: 0.00832 | Combo score: 0.490 | Smoothed: 0.487 | MCC: 0.386 | REC: 0.435 | PRE: 0.396 | AUC: 0.831 | Threshold: 0.02262
Epoch 29 | Train loss: 0.00598 | Val loss: 0.00842 | Combo score: 0.488 | Smoothed: 0.487 | MCC: 0.378 | REC: 0.405 | PRE: 0.408 | AUC: 0.838 | Threshold: 0.02568
Epoch 30 | Train loss: 0.00571 | Val loss: 0.00830 | Combo score: 0.491 | Smoothed: 0.488 | MCC: 0.386 | REC: 0.450 | PRE: 0.386 | AUC: 0.834 | Threshold: 0.02352
Epoch 31 | Train loss: 0.00553 | Val loss: 0.00874 | Combo score: 0.494 | Smoothed: 0.488 | MCC: 0.392 | REC: 0.458 | PRE: 0.390 | AUC: 0.837 | Threshold: 0.02489
Epoch 32 | Train loss: 0.00541 | Val loss: 0.00822 | Combo score: 0.494 | Smoothed: 0.489 | MCC: 0.391 | REC: 0.466 | PRE: 0.381 | AUC: 0.844 | Threshold: 0.02434
Epoch 33 | Train loss: 0.00527 | Val loss: 0.00788 | Combo score: 0.489 | Smoothed: 0.489 | MCC: 0.379 | REC: 0.412 | PRE: 0.403 | AUC: 0.844 | Threshold: 0.02538
Epoch 34 | Train loss: 0.00568 | Val loss: 0.00814 | Combo score: 0.492 | Smoothed: 0.489 | MCC: 0.386 | REC: 0.450 | PRE: 0.386 | AUC: 0.841 | Threshold: 0.02284
Epoch 35 | Train loss: 0.00521 | Val loss: 0.00773 | Combo score: 0.484 | Smoothed: 0.489 | MCC: 0.367 | REC: 0.458 | PRE: 0.349 | AUC: 0.836 | Threshold: 0.02200
Epoch 36 | Train loss: 0.00500 | Val loss: 0.00762 | Combo score: 0.490 | Smoothed: 0.489 | MCC: 0.381 | REC: 0.435 | PRE: 0.388 | AUC: 0.849 | Threshold: 0.02378
Epoch 37 | Train loss: 0.00494 | Val loss: 0.00776 | Combo score: 0.490 | Smoothed: 0.489 | MCC: 0.381 | REC: 0.412 | PRE: 0.406 | AUC: 0.854 | Threshold: 0.02706
Epoch 38 | Train loss: 0.00482 | Val loss: 0.00761 | Combo score: 0.488 | Smoothed: 0.489 | MCC: 0.373 | REC: 0.420 | PRE: 0.387 | AUC: 0.859 | Threshold: 0.02637
Epoch 39 | Train loss: 0.00472 | Val loss: 0.00746 | Combo score: 0.485 | Smoothed: 0.489 | MCC: 0.369 | REC: 0.412 | PRE: 0.386 | AUC: 0.849 | Threshold: 0.02435
Epoch 40 | Train loss: 0.00466 | Val loss: 0.00720 | Combo score: 0.494 | Smoothed: 0.489 | MCC: 0.389 | REC: 0.435 | PRE: 0.401 | AUC: 0.855 | Threshold: 0.02418
Epoch 41 | Train loss: 0.00455 | Val loss: 0.00747 | Combo score: 0.493 | Smoothed: 0.489 | MCC: 0.387 | REC: 0.420 | PRE: 0.410 | AUC: 0.852 | Threshold: 0.02690
Epoch 42 | Train loss: 0.00444 | Val loss: 0.00707 | Combo score: 0.494 | Smoothed: 0.490 | MCC: 0.392 | REC: 0.435 | PRE: 0.407 | AUC: 0.846 | Threshold: 0.02508
Epoch 43 | Train loss: 0.00433 | Val loss: 0.00674 | Combo score: 0.485 | Smoothed: 0.490 | MCC: 0.369 | REC: 0.450 | PRE: 0.358 | AUC: 0.843 | Threshold: 0.02012
Epoch 44 | Train loss: 0.00418 | Val loss: 0.00703 | Combo score: 0.496 | Smoothed: 0.490 | MCC: 0.397 | REC: 0.443 | PRE: 0.408 | AUC: 0.847 | Threshold: 0.02486
Epoch 45 | Train loss: 0.00409 | Val loss: 0.00699 | Combo score: 0.494 | Smoothed: 0.491 | MCC: 0.390 | REC: 0.443 | PRE: 0.397 | AUC: 0.849 | Threshold: 0.02556
Epoch 46 | Train loss: 0.00399 | Val loss: 0.00678 | Combo score: 0.493 | Smoothed: 0.491 | MCC: 0.388 | REC: 0.443 | PRE: 0.395 | AUC: 0.845 | Threshold: 0.02576
Epoch 47 | Train loss: 0.00394 | Val loss: 0.00743 | Combo score: 0.485 | Smoothed: 0.490 | MCC: 0.369 | REC: 0.427 | PRE: 0.373 | AUC: 0.840 | Threshold: 0.02371
Epoch 48 | Train loss: 0.00410 | Val loss: 0.00659 | Combo score: 0.489 | Smoothed: 0.490 | MCC: 0.380 | REC: 0.405 | PRE: 0.411 | AUC: 0.841 | Threshold: 0.02530
Epoch 49 | Train loss: 0.00384 | Val loss: 0.00648 | Combo score: 0.491 | Smoothed: 0.490 | MCC: 0.387 | REC: 0.420 | PRE: 0.410 | AUC: 0.833 | Threshold: 0.02345
Epoch 50 | Train loss: 0.00374 | Val loss: 0.00710 | Combo score: 0.488 | Smoothed: 0.490 | MCC: 0.380 | REC: 0.405 | PRE: 0.411 | AUC: 0.838 | Threshold: 0.02840
Epoch 51 | Train loss: 0.00370 | Val loss: 0.00643 | Combo score: 0.488 | Smoothed: 0.490 | MCC: 0.375 | REC: 0.420 | PRE: 0.390 | AUC: 0.846 | Threshold: 0.02496
Epoch 52 | Train loss: 0.00373 | Val loss: 0.00649 | Combo score: 0.491 | Smoothed: 0.490 | MCC: 0.384 | REC: 0.435 | PRE: 0.393 | AUC: 0.840 | Threshold: 0.02370
Epoch 53 | Train loss: 0.00360 | Val loss: 0.00662 | Combo score: 0.487 | Smoothed: 0.490 | MCC: 0.376 | REC: 0.405 | PRE: 0.405 | AUC: 0.841 | Threshold: 0.02723
Epoch 54 | Train loss: 0.00350 | Val loss: 0.00615 | Combo score: 0.487 | Smoothed: 0.489 | MCC: 0.376 | REC: 0.405 | PRE: 0.405 | AUC: 0.837 | Threshold: 0.02464
Epoch 55 | Train loss: 0.00349 | Val loss: 0.00616 | Combo score: 0.488 | Smoothed: 0.489 | MCC: 0.378 | REC: 0.405 | PRE: 0.408 | AUC: 0.837 | Threshold: 0.02439
Epoch 56 | Train loss: 0.00343 | Val loss: 0.00663 | Combo score: 0.488 | Smoothed: 0.489 | MCC: 0.378 | REC: 0.405 | PRE: 0.408 | AUC: 0.839 | Threshold: 0.02627
Early stopping at epoch 56 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 6 summary (years: [2010, 2011]) ---
Best epoch: 25
Threshold used: 0.02619
Validation metrics:
ACC: 94.6%
PRE: 41.4%
REC: 44.3%
MCC: 0.40
AUC: 0.84
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 7 (years: [2011, 2012])
Epoch 01 | Train loss: 0.05964 | Val loss: 0.02979 | Combo score: 0.483 | Smoothed: 0.483 | MCC: 0.362 | REC: 0.430 | PRE: 0.386 | AUC: 0.834 | Threshold: 0.05467
Epoch 02 | Train loss: 0.02795 | Val loss: 0.02673 | Combo score: 0.488 | Smoothed: 0.483 | MCC: 0.370 | REC: 0.523 | PRE: 0.340 | AUC: 0.836 | Threshold: 0.04808
Epoch 03 | Train loss: 0.02198 | Val loss: 0.02490 | Combo score: 0.484 | Smoothed: 0.483 | MCC: 0.365 | REC: 0.461 | PRE: 0.369 | AUC: 0.833 | Threshold: 0.05485
Epoch 04 | Train loss: 0.02036 | Val loss: 0.02388 | Combo score: 0.484 | Smoothed: 0.484 | MCC: 0.366 | REC: 0.461 | PRE: 0.371 | AUC: 0.824 | Threshold: 0.05523
Epoch 05 | Train loss: 0.01999 | Val loss: 0.02349 | Combo score: 0.485 | Smoothed: 0.484 | MCC: 0.363 | REC: 0.523 | PRE: 0.331 | AUC: 0.834 | Threshold: 0.04465
Epoch 06 | Train loss: 0.01963 | Val loss: 0.02372 | Combo score: 0.484 | Smoothed: 0.484 | MCC: 0.366 | REC: 0.461 | PRE: 0.371 | AUC: 0.827 | Threshold: 0.05677
Epoch 07 | Train loss: 0.01932 | Val loss: 0.02353 | Combo score: 0.488 | Smoothed: 0.484 | MCC: 0.370 | REC: 0.472 | PRE: 0.370 | AUC: 0.845 | Threshold: 0.05273
Epoch 08 | Train loss: 0.01885 | Val loss: 0.01560 | Combo score: 0.502 | Smoothed: 0.486 | MCC: 0.394 | REC: 0.668 | PRE: 0.304 | AUC: 0.848 | Threshold: 0.02513
Epoch 09 | Train loss: 0.01138 | Val loss: 0.01298 | Combo score: 0.510 | Smoothed: 0.488 | MCC: 0.409 | REC: 0.668 | PRE: 0.321 | AUC: 0.876 | Threshold: 0.02181
Epoch 10 | Train loss: 0.01068 | Val loss: 0.01267 | Combo score: 0.504 | Smoothed: 0.490 | MCC: 0.400 | REC: 0.565 | PRE: 0.359 | AUC: 0.878 | Threshold: 0.02423
Epoch 11 | Train loss: 0.01042 | Val loss: 0.01296 | Combo score: 0.507 | Smoothed: 0.492 | MCC: 0.406 | REC: 0.611 | PRE: 0.342 | AUC: 0.880 | Threshold: 0.02390
Epoch 12 | Train loss: 0.01022 | Val loss: 0.01306 | Combo score: 0.498 | Smoothed: 0.492 | MCC: 0.386 | REC: 0.554 | PRE: 0.345 | AUC: 0.870 | Threshold: 0.02399
Epoch 13 | Train loss: 0.01022 | Val loss: 0.01251 | Combo score: 0.494 | Smoothed: 0.492 | MCC: 0.374 | REC: 0.570 | PRE: 0.323 | AUC: 0.869 | Threshold: 0.02343
Epoch 14 | Train loss: 0.00998 | Val loss: 0.01261 | Combo score: 0.517 | Smoothed: 0.495 | MCC: 0.430 | REC: 0.627 | PRE: 0.366 | AUC: 0.884 | Threshold: 0.02336
Epoch 15 | Train loss: 0.01115 | Val loss: 0.01323 | Combo score: 0.470 | Smoothed: 0.492 | MCC: 0.318 | REC: 0.513 | PRE: 0.280 | AUC: 0.851 | Threshold: 0.02286
Epoch 16 | Train loss: 0.01070 | Val loss: 0.01246 | Combo score: 0.476 | Smoothed: 0.491 | MCC: 0.327 | REC: 0.580 | PRE: 0.264 | AUC: 0.853 | Threshold: 0.02120
Epoch 17 | Train loss: 0.00852 | Val loss: 0.00948 | Combo score: 0.487 | Smoothed: 0.490 | MCC: 0.359 | REC: 0.513 | PRE: 0.331 | AUC: 0.870 | Threshold: 0.02001
Epoch 18 | Train loss: 0.00727 | Val loss: 0.00854 | Combo score: 0.481 | Smoothed: 0.489 | MCC: 0.342 | REC: 0.565 | PRE: 0.286 | AUC: 0.856 | Threshold: 0.01511
Epoch 19 | Train loss: 0.00663 | Val loss: 0.00768 | Combo score: 0.482 | Smoothed: 0.489 | MCC: 0.348 | REC: 0.544 | PRE: 0.302 | AUC: 0.849 | Threshold: 0.01460
Epoch 20 | Train loss: 0.00632 | Val loss: 0.00818 | Combo score: 0.488 | Smoothed: 0.489 | MCC: 0.369 | REC: 0.492 | PRE: 0.356 | AUC: 0.854 | Threshold: 0.01992
Epoch 21 | Train loss: 0.00596 | Val loss: 0.00764 | Combo score: 0.488 | Smoothed: 0.488 | MCC: 0.367 | REC: 0.451 | PRE: 0.378 | AUC: 0.862 | Threshold: 0.01923
Epoch 22 | Train loss: 0.00585 | Val loss: 0.00711 | Combo score: 0.481 | Smoothed: 0.488 | MCC: 0.358 | REC: 0.466 | PRE: 0.356 | AUC: 0.826 | Threshold: 0.01763
Epoch 23 | Train loss: 0.00554 | Val loss: 0.00708 | Combo score: 0.485 | Smoothed: 0.487 | MCC: 0.360 | REC: 0.466 | PRE: 0.359 | AUC: 0.855 | Threshold: 0.01642
Epoch 24 | Train loss: 0.00539 | Val loss: 0.00706 | Combo score: 0.481 | Smoothed: 0.487 | MCC: 0.350 | REC: 0.446 | PRE: 0.357 | AUC: 0.857 | Threshold: 0.01808
Early stopping at epoch 24 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 7 summary (years: [2011, 2012]) ---
Best epoch: 14
Threshold used: 0.02336
Validation metrics:
ACC: 90.2%
PRE: 36.6%
REC: 62.7%
MCC: 0.43
AUC: 0.88
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 8 (years: [2012, 2013])
Epoch 01 | Train loss: 0.05593 | Val loss: 0.03355 | Combo score: 0.478 | Smoothed: 0.478 | MCC: 0.368 | REC: 0.387 | PRE: 0.466 | AUC: 0.751 | Threshold: 0.08211
Epoch 02 | Train loss: 0.02108 | Val loss: 0.01494 | Combo score: 0.556 | Smoothed: 0.486 | MCC: 0.520 | REC: 0.764 | PRE: 0.439 | AUC: 0.895 | Threshold: 0.02378
Epoch 03 | Train loss: 0.01351 | Val loss: 0.01312 | Combo score: 0.559 | Smoothed: 0.493 | MCC: 0.528 | REC: 0.771 | PRE: 0.446 | AUC: 0.896 | Threshold: 0.02088
Epoch 04 | Train loss: 0.01128 | Val loss: 0.00917 | Combo score: 0.457 | Smoothed: 0.490 | MCC: 0.297 | REC: 0.440 | PRE: 0.325 | AUC: 0.794 | Threshold: 0.01548
Epoch 05 | Train loss: 0.00975 | Val loss: 0.00882 | Combo score: 0.466 | Smoothed: 0.487 | MCC: 0.317 | REC: 0.430 | PRE: 0.356 | AUC: 0.821 | Threshold: 0.01626
Epoch 06 | Train loss: 0.00910 | Val loss: 0.00834 | Combo score: 0.484 | Smoothed: 0.487 | MCC: 0.342 | REC: 0.736 | PRE: 0.265 | AUC: 0.811 | Threshold: 0.01007
Epoch 07 | Train loss: 0.00874 | Val loss: 0.00779 | Combo score: 0.465 | Smoothed: 0.485 | MCC: 0.316 | REC: 0.405 | PRE: 0.370 | AUC: 0.817 | Threshold: 0.01500
Epoch 08 | Train loss: 0.00808 | Val loss: 0.00767 | Combo score: 0.467 | Smoothed: 0.483 | MCC: 0.322 | REC: 0.398 | PRE: 0.383 | AUC: 0.812 | Threshold: 0.01583
Epoch 09 | Train loss: 0.00765 | Val loss: 0.00725 | Combo score: 0.476 | Smoothed: 0.482 | MCC: 0.349 | REC: 0.387 | PRE: 0.433 | AUC: 0.807 | Threshold: 0.01777
Epoch 10 | Train loss: 0.00763 | Val loss: 0.00678 | Combo score: 0.465 | Smoothed: 0.481 | MCC: 0.314 | REC: 0.405 | PRE: 0.366 | AUC: 0.819 | Threshold: 0.01347
Epoch 11 | Train loss: 0.00704 | Val loss: 0.00661 | Combo score: 0.478 | Smoothed: 0.480 | MCC: 0.334 | REC: 0.609 | PRE: 0.297 | AUC: 0.827 | Threshold: 0.00936
Epoch 12 | Train loss: 0.00677 | Val loss: 0.00649 | Combo score: 0.473 | Smoothed: 0.480 | MCC: 0.328 | REC: 0.504 | PRE: 0.332 | AUC: 0.831 | Threshold: 0.01121
Epoch 13 | Train loss: 0.00661 | Val loss: 0.00663 | Combo score: 0.474 | Smoothed: 0.479 | MCC: 0.324 | REC: 0.574 | PRE: 0.299 | AUC: 0.827 | Threshold: 0.01009
Epoch 14 | Train loss: 0.00642 | Val loss: 0.00631 | Combo score: 0.465 | Smoothed: 0.478 | MCC: 0.312 | REC: 0.444 | PRE: 0.341 | AUC: 0.820 | Threshold: 0.01123
Epoch 15 | Train loss: 0.00627 | Val loss: 0.00660 | Combo score: 0.480 | Smoothed: 0.478 | MCC: 0.353 | REC: 0.391 | PRE: 0.437 | AUC: 0.827 | Threshold: 0.01826
Epoch 16 | Train loss: 0.00604 | Val loss: 0.00649 | Combo score: 0.480 | Smoothed: 0.478 | MCC: 0.350 | REC: 0.391 | PRE: 0.432 | AUC: 0.841 | Threshold: 0.01796
Epoch 17 | Train loss: 0.00595 | Val loss: 0.00584 | Combo score: 0.465 | Smoothed: 0.477 | MCC: 0.318 | REC: 0.391 | PRE: 0.381 | AUC: 0.811 | Threshold: 0.01397
Epoch 18 | Train loss: 0.00570 | Val loss: 0.00602 | Combo score: 0.471 | Smoothed: 0.476 | MCC: 0.328 | REC: 0.475 | PRE: 0.345 | AUC: 0.821 | Threshold: 0.01038
Epoch 19 | Train loss: 0.00507 | Val loss: 0.00431 | Combo score: 0.506 | Smoothed: 0.479 | MCC: 0.396 | REC: 0.792 | PRE: 0.296 | AUC: 0.829 | Threshold: 0.00572
Epoch 20 | Train loss: 0.00464 | Val loss: 0.00389 | Combo score: 0.419 | Smoothed: 0.473 | MCC: 0.195 | REC: 0.577 | PRE: 0.187 | AUC: 0.726 | Threshold: 0.00446
Epoch 21 | Train loss: 0.00445 | Val loss: 0.00392 | Combo score: 0.436 | Smoothed: 0.469 | MCC: 0.222 | REC: 0.711 | PRE: 0.183 | AUC: 0.742 | Threshold: 0.00367
Epoch 22 | Train loss: 0.00424 | Val loss: 0.00347 | Combo score: 0.394 | Smoothed: 0.462 | MCC: 0.142 | REC: 0.518 | PRE: 0.161 | AUC: 0.672 | Threshold: 0.00385
Epoch 23 | Train loss: 0.00413 | Val loss: 0.00352 | Combo score: 0.417 | Smoothed: 0.457 | MCC: 0.214 | REC: 0.401 | PRE: 0.244 | AUC: 0.710 | Threshold: 0.00557
Epoch 24 | Train loss: 0.00395 | Val loss: 0.00333 | Combo score: 0.417 | Smoothed: 0.453 | MCC: 0.190 | REC: 0.570 | PRE: 0.185 | AUC: 0.716 | Threshold: 0.00369
Early stopping at epoch 24 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 8 summary (years: [2012, 2013]) ---
Best epoch: 3
Threshold used: 0.02088
Validation metrics:
ACC: 88.2%
PRE: 44.6%
REC: 77.1%
MCC: 0.53
AUC: 0.90
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 9 (years: [2013, 2014])
Epoch 01 | Train loss: 0.06606 | Val loss: 0.03811 | Combo score: 0.500 | Smoothed: 0.500 | MCC: 0.422 | REC: 0.447 | PRE: 0.513 | AUC: 0.756 | Threshold: 0.07436
Epoch 02 | Train loss: 0.01867 | Val loss: 0.01512 | Combo score: 0.522 | Smoothed: 0.502 | MCC: 0.441 | REC: 0.659 | PRE: 0.402 | AUC: 0.862 | Threshold: 0.02170
Epoch 03 | Train loss: 0.01360 | Val loss: 0.01359 | Combo score: 0.499 | Smoothed: 0.502 | MCC: 0.397 | REC: 0.457 | PRE: 0.463 | AUC: 0.841 | Threshold: 0.02314
Epoch 04 | Train loss: 0.01327 | Val loss: 0.01364 | Combo score: 0.519 | Smoothed: 0.504 | MCC: 0.436 | REC: 0.619 | PRE: 0.416 | AUC: 0.868 | Threshold: 0.02085
Epoch 05 | Train loss: 0.01249 | Val loss: 0.01339 | Combo score: 0.518 | Smoothed: 0.505 | MCC: 0.438 | REC: 0.543 | PRE: 0.463 | AUC: 0.868 | Threshold: 0.02288
Epoch 06 | Train loss: 0.01213 | Val loss: 0.01284 | Combo score: 0.524 | Smoothed: 0.507 | MCC: 0.449 | REC: 0.613 | PRE: 0.436 | AUC: 0.868 | Threshold: 0.02055
Epoch 07 | Train loss: 0.01251 | Val loss: 0.01284 | Combo score: 0.527 | Smoothed: 0.509 | MCC: 0.462 | REC: 0.490 | PRE: 0.542 | AUC: 0.874 | Threshold: 0.02302
Epoch 08 | Train loss: 0.01185 | Val loss: 0.01374 | Combo score: 0.548 | Smoothed: 0.513 | MCC: 0.504 | REC: 0.649 | PRE: 0.490 | AUC: 0.899 | Threshold: 0.02394
Epoch 09 | Train loss: 0.01030 | Val loss: 0.00956 | Combo score: 0.458 | Smoothed: 0.508 | MCC: 0.308 | REC: 0.434 | PRE: 0.349 | AUC: 0.767 | Threshold: 0.01652
Epoch 10 | Train loss: 0.00943 | Val loss: 0.00902 | Combo score: 0.459 | Smoothed: 0.503 | MCC: 0.300 | REC: 0.563 | PRE: 0.285 | AUC: 0.769 | Threshold: 0.01272
Epoch 11 | Train loss: 0.00905 | Val loss: 0.00881 | Combo score: 0.460 | Smoothed: 0.498 | MCC: 0.297 | REC: 0.613 | PRE: 0.267 | AUC: 0.767 | Threshold: 0.01160
Epoch 12 | Train loss: 0.00876 | Val loss: 0.00796 | Combo score: 0.443 | Smoothed: 0.493 | MCC: 0.270 | REC: 0.474 | PRE: 0.286 | AUC: 0.744 | Threshold: 0.01211
Epoch 13 | Train loss: 0.00848 | Val loss: 0.00831 | Combo score: 0.456 | Smoothed: 0.489 | MCC: 0.300 | REC: 0.467 | PRE: 0.323 | AUC: 0.769 | Threshold: 0.01350
Epoch 14 | Train loss: 0.00825 | Val loss: 0.00818 | Combo score: 0.507 | Smoothed: 0.491 | MCC: 0.415 | REC: 0.606 | PRE: 0.396 | AUC: 0.828 | Threshold: 0.01462
Epoch 15 | Train loss: 0.00762 | Val loss: 0.00753 | Combo score: 0.479 | Smoothed: 0.490 | MCC: 0.347 | REC: 0.573 | PRE: 0.331 | AUC: 0.795 | Threshold: 0.01168
Epoch 16 | Train loss: 0.00724 | Val loss: 0.00734 | Combo score: 0.490 | Smoothed: 0.490 | MCC: 0.376 | REC: 0.573 | PRE: 0.364 | AUC: 0.805 | Threshold: 0.01199
Epoch 17 | Train loss: 0.00698 | Val loss: 0.00718 | Combo score: 0.490 | Smoothed: 0.490 | MCC: 0.376 | REC: 0.596 | PRE: 0.354 | AUC: 0.801 | Threshold: 0.01121
Epoch 18 | Train loss: 0.00663 | Val loss: 0.00647 | Combo score: 0.470 | Smoothed: 0.488 | MCC: 0.322 | REC: 0.593 | PRE: 0.297 | AUC: 0.784 | Threshold: 0.00976
Epoch 19 | Train loss: 0.00643 | Val loss: 0.00714 | Combo score: 0.506 | Smoothed: 0.490 | MCC: 0.409 | REC: 0.642 | PRE: 0.371 | AUC: 0.831 | Threshold: 0.01161
Epoch 20 | Train loss: 0.00628 | Val loss: 0.00877 | Combo score: 0.565 | Smoothed: 0.497 | MCC: 0.544 | REC: 0.825 | PRE: 0.444 | AUC: 0.888 | Threshold: 0.01443
Epoch 21 | Train loss: 0.00629 | Val loss: 0.00581 | Combo score: 0.470 | Smoothed: 0.495 | MCC: 0.313 | REC: 0.745 | PRE: 0.246 | AUC: 0.764 | Threshold: 0.00661
Epoch 22 | Train loss: 0.00628 | Val loss: 0.00668 | Combo score: 0.489 | Smoothed: 0.494 | MCC: 0.370 | REC: 0.619 | PRE: 0.338 | AUC: 0.803 | Threshold: 0.00993
Epoch 23 | Train loss: 0.00570 | Val loss: 0.00433 | Combo score: 0.438 | Smoothed: 0.488 | MCC: 0.257 | REC: 0.464 | PRE: 0.275 | AUC: 0.737 | Threshold: 0.00687
Epoch 24 | Train loss: 0.00536 | Val loss: 0.00421 | Combo score: 0.444 | Smoothed: 0.484 | MCC: 0.285 | REC: 0.414 | PRE: 0.329 | AUC: 0.711 | Threshold: 0.00787
Epoch 25 | Train loss: 0.00490 | Val loss: 0.00413 | Combo score: 0.435 | Smoothed: 0.479 | MCC: 0.263 | REC: 0.391 | PRE: 0.313 | AUC: 0.707 | Threshold: 0.00757
Epoch 26 | Train loss: 0.00469 | Val loss: 0.00394 | Combo score: 0.428 | Smoothed: 0.474 | MCC: 0.245 | REC: 0.381 | PRE: 0.296 | AUC: 0.702 | Threshold: 0.00722
Epoch 27 | Train loss: 0.00459 | Val loss: 0.00378 | Combo score: 0.403 | Smoothed: 0.467 | MCC: 0.181 | REC: 0.377 | PRE: 0.226 | AUC: 0.686 | Threshold: 0.00604
Epoch 28 | Train loss: 0.00446 | Val loss: 0.00377 | Combo score: 0.430 | Smoothed: 0.463 | MCC: 0.253 | REC: 0.368 | PRE: 0.312 | AUC: 0.698 | Threshold: 0.00720
Epoch 29 | Train loss: 0.00434 | Val loss: 0.00377 | Combo score: 0.413 | Smoothed: 0.458 | MCC: 0.211 | REC: 0.387 | PRE: 0.253 | AUC: 0.676 | Threshold: 0.00636
Epoch 30 | Train loss: 0.00423 | Val loss: 0.00395 | Combo score: 0.426 | Smoothed: 0.455 | MCC: 0.247 | REC: 0.368 | PRE: 0.304 | AUC: 0.682 | Threshold: 0.00732
Early stopping at epoch 30 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 9 summary (years: [2013, 2014]) ---
Best epoch: 20
Threshold used: 0.01443
Validation metrics:
ACC: 87.3%
PRE: 44.4%
REC: 82.5%
MCC: 0.54
AUC: 0.89
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 10 (years: [2014, 2015])
Epoch 01 | Train loss: 0.06610 | Val loss: 0.06357 | Combo score: 0.508 | Smoothed: 0.508 | MCC: 0.425 | REC: 0.478 | PRE: 0.488 | AUC: 0.822 | Threshold: 0.12713
Epoch 02 | Train loss: 0.04594 | Val loss: 0.03887 | Combo score: 0.456 | Smoothed: 0.503 | MCC: 0.314 | REC: 0.372 | PRE: 0.392 | AUC: 0.733 | Threshold: 0.07337
Epoch 03 | Train loss: 0.02331 | Val loss: 0.01862 | Combo score: 0.446 | Smoothed: 0.497 | MCC: 0.256 | REC: 0.730 | PRE: 0.205 | AUC: 0.725 | Threshold: 0.01973
Epoch 04 | Train loss: 0.01830 | Val loss: 0.01824 | Combo score: 0.452 | Smoothed: 0.492 | MCC: 0.271 | REC: 0.693 | PRE: 0.223 | AUC: 0.744 | Threshold: 0.02173
Epoch 05 | Train loss: 0.01801 | Val loss: 0.01877 | Combo score: 0.453 | Smoothed: 0.488 | MCC: 0.267 | REC: 0.717 | PRE: 0.215 | AUC: 0.763 | Threshold: 0.02130
Epoch 06 | Train loss: 0.01799 | Val loss: 0.01834 | Combo score: 0.460 | Smoothed: 0.486 | MCC: 0.289 | REC: 0.710 | PRE: 0.232 | AUC: 0.757 | Threshold: 0.02184
Epoch 07 | Train loss: 0.01777 | Val loss: 0.01756 | Combo score: 0.413 | Smoothed: 0.478 | MCC: 0.170 | REC: 0.730 | PRE: 0.156 | AUC: 0.674 | Threshold: 0.01537
Epoch 08 | Train loss: 0.01777 | Val loss: 0.01810 | Combo score: 0.441 | Smoothed: 0.475 | MCC: 0.241 | REC: 0.706 | PRE: 0.199 | AUC: 0.731 | Threshold: 0.01955
Epoch 09 | Train loss: 0.01774 | Val loss: 0.01793 | Combo score: 0.429 | Smoothed: 0.470 | MCC: 0.210 | REC: 0.730 | PRE: 0.177 | AUC: 0.704 | Threshold: 0.01724
Epoch 10 | Train loss: 0.01771 | Val loss: 0.01830 | Combo score: 0.455 | Smoothed: 0.468 | MCC: 0.278 | REC: 0.696 | PRE: 0.227 | AUC: 0.754 | Threshold: 0.02153
Epoch 11 | Train loss: 0.01770 | Val loss: 0.01820 | Combo score: 0.453 | Smoothed: 0.467 | MCC: 0.270 | REC: 0.724 | PRE: 0.215 | AUC: 0.751 | Threshold: 0.02079
Epoch 12 | Train loss: 0.01763 | Val loss: 0.01759 | Combo score: 0.419 | Smoothed: 0.462 | MCC: 0.192 | REC: 0.683 | PRE: 0.173 | AUC: 0.685 | Threshold: 0.01771
Epoch 13 | Train loss: 0.01763 | Val loss: 0.01810 | Combo score: 0.462 | Smoothed: 0.462 | MCC: 0.295 | REC: 0.713 | PRE: 0.236 | AUC: 0.760 | Threshold: 0.02154
Epoch 14 | Train loss: 0.01763 | Val loss: 0.01818 | Combo score: 0.456 | Smoothed: 0.461 | MCC: 0.281 | REC: 0.700 | PRE: 0.228 | AUC: 0.753 | Threshold: 0.02134
Epoch 15 | Train loss: 0.01762 | Val loss: 0.01805 | Combo score: 0.447 | Smoothed: 0.460 | MCC: 0.256 | REC: 0.720 | PRE: 0.206 | AUC: 0.738 | Threshold: 0.01942
Epoch 16 | Train loss: 0.01763 | Val loss: 0.01873 | Combo score: 0.465 | Smoothed: 0.461 | MCC: 0.300 | REC: 0.706 | PRE: 0.241 | AUC: 0.777 | Threshold: 0.02341
Epoch 17 | Train loss: 0.01763 | Val loss: 0.01833 | Combo score: 0.460 | Smoothed: 0.461 | MCC: 0.290 | REC: 0.703 | PRE: 0.234 | AUC: 0.764 | Threshold: 0.02208
Epoch 18 | Train loss: 0.01760 | Val loss: 0.01821 | Combo score: 0.457 | Smoothed: 0.460 | MCC: 0.281 | REC: 0.741 | PRE: 0.219 | AUC: 0.747 | Threshold: 0.02020
Epoch 19 | Train loss: 0.01759 | Val loss: 0.01788 | Combo score: 0.436 | Smoothed: 0.458 | MCC: 0.232 | REC: 0.693 | PRE: 0.196 | AUC: 0.721 | Threshold: 0.01890
Epoch 20 | Train loss: 0.01760 | Val loss: 0.01878 | Combo score: 0.465 | Smoothed: 0.458 | MCC: 0.302 | REC: 0.679 | PRE: 0.250 | AUC: 0.778 | Threshold: 0.02422
Epoch 21 | Train loss: 0.01763 | Val loss: 0.01804 | Combo score: 0.443 | Smoothed: 0.457 | MCC: 0.250 | REC: 0.693 | PRE: 0.207 | AUC: 0.729 | Threshold: 0.01993
Epoch 22 | Train loss: 0.01757 | Val loss: 0.01842 | Combo score: 0.465 | Smoothed: 0.458 | MCC: 0.301 | REC: 0.706 | PRE: 0.242 | AUC: 0.771 | Threshold: 0.02252
Epoch 23 | Train loss: 0.01758 | Val loss: 0.01809 | Combo score: 0.457 | Smoothed: 0.458 | MCC: 0.283 | REC: 0.717 | PRE: 0.226 | AUC: 0.750 | Threshold: 0.02050
Epoch 24 | Train loss: 0.01757 | Val loss: 0.01807 | Combo score: 0.443 | Smoothed: 0.456 | MCC: 0.237 | REC: 0.819 | PRE: 0.179 | AUC: 0.718 | Threshold: 0.01561
Early stopping at epoch 24 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 10 summary (years: [2014, 2015]) ---
Best epoch: 1
Threshold used: 0.12713
Validation metrics:
ACC: 89.5%
PRE: 48.8%
REC: 47.8%
MCC: 0.42
AUC: 0.82
==================================================


==================================================
Training Bi-LSTM-AE with sequence length: 2_week | Fold 11 (years: [2015, 2016])
Epoch 01 | Train loss: 0.06413 | Val loss: 0.03721 | Combo score: 0.448 | Smoothed: 0.448 | MCC: 0.254 | REC: 0.737 | PRE: 0.193 | AUC: 0.757 | Threshold: 0.03899
Epoch 02 | Train loss: 0.02792 | Val loss: 0.02023 | Combo score: 0.430 | Smoothed: 0.446 | MCC: 0.220 | REC: 0.737 | PRE: 0.172 | AUC: 0.689 | Threshold: 0.02157
Epoch 03 | Train loss: 0.01565 | Val loss: 0.01579 | Combo score: 0.493 | Smoothed: 0.451 | MCC: 0.363 | REC: 0.781 | PRE: 0.265 | AUC: 0.818 | Threshold: 0.02080
Epoch 04 | Train loss: 0.01277 | Val loss: 0.01465 | Combo score: 0.488 | Smoothed: 0.455 | MCC: 0.350 | REC: 0.793 | PRE: 0.252 | AUC: 0.808 | Threshold: 0.01856
Epoch 05 | Train loss: 0.01201 | Val loss: 0.01500 | Combo score: 0.503 | Smoothed: 0.460 | MCC: 0.385 | REC: 0.807 | PRE: 0.277 | AUC: 0.831 | Threshold: 0.01999
Epoch 06 | Train loss: 0.01181 | Val loss: 0.01475 | Combo score: 0.492 | Smoothed: 0.463 | MCC: 0.359 | REC: 0.781 | PRE: 0.262 | AUC: 0.819 | Threshold: 0.01942
Epoch 07 | Train loss: 0.01100 | Val loss: 0.01312 | Combo score: 0.489 | Smoothed: 0.465 | MCC: 0.353 | REC: 0.796 | PRE: 0.253 | AUC: 0.807 | Threshold: 0.01707
Epoch 08 | Train loss: 0.01046 | Val loss: 0.01209 | Combo score: 0.437 | Smoothed: 0.463 | MCC: 0.255 | REC: 0.478 | PRE: 0.255 | AUC: 0.742 | Threshold: 0.01899
Epoch 09 | Train loss: 0.01015 | Val loss: 0.01221 | Combo score: 0.441 | Smoothed: 0.460 | MCC: 0.266 | REC: 0.452 | PRE: 0.276 | AUC: 0.749 | Threshold: 0.02050
Epoch 10 | Train loss: 0.00992 | Val loss: 0.01219 | Combo score: 0.454 | Smoothed: 0.460 | MCC: 0.298 | REC: 0.437 | PRE: 0.322 | AUC: 0.766 | Threshold: 0.02263
Epoch 11 | Train loss: 0.00973 | Val loss: 0.01151 | Combo score: 0.445 | Smoothed: 0.458 | MCC: 0.279 | REC: 0.444 | PRE: 0.294 | AUC: 0.742 | Threshold: 0.02013
Epoch 12 | Train loss: 0.00959 | Val loss: 0.01138 | Combo score: 0.438 | Smoothed: 0.456 | MCC: 0.259 | REC: 0.459 | PRE: 0.266 | AUC: 0.741 | Threshold: 0.01878
Epoch 13 | Train loss: 0.00946 | Val loss: 0.01113 | Combo score: 0.433 | Smoothed: 0.454 | MCC: 0.251 | REC: 0.474 | PRE: 0.252 | AUC: 0.715 | Threshold: 0.01758
Epoch 14 | Train loss: 0.00924 | Val loss: 0.01075 | Combo score: 0.432 | Smoothed: 0.452 | MCC: 0.246 | REC: 0.500 | PRE: 0.239 | AUC: 0.713 | Threshold: 0.01678
Epoch 15 | Train loss: 0.00899 | Val loss: 0.01119 | Combo score: 0.449 | Smoothed: 0.451 | MCC: 0.291 | REC: 0.456 | PRE: 0.304 | AUC: 0.733 | Threshold: 0.02084
Epoch 16 | Train loss: 0.00866 | Val loss: 0.01072 | Combo score: 0.441 | Smoothed: 0.450 | MCC: 0.270 | REC: 0.496 | PRE: 0.264 | AUC: 0.716 | Threshold: 0.01784
Epoch 17 | Train loss: 0.00786 | Val loss: 0.00827 | Combo score: 0.438 | Smoothed: 0.449 | MCC: 0.237 | REC: 0.707 | PRE: 0.187 | AUC: 0.727 | Threshold: 0.00898
Epoch 18 | Train loss: 0.00706 | Val loss: 0.00963 | Combo score: 0.481 | Smoothed: 0.452 | MCC: 0.364 | REC: 0.441 | PRE: 0.412 | AUC: 0.788 | Threshold: 0.02245
Epoch 19 | Train loss: 0.00675 | Val loss: 0.00848 | Combo score: 0.479 | Smoothed: 0.455 | MCC: 0.358 | REC: 0.419 | PRE: 0.419 | AUC: 0.798 | Threshold: 0.02093
Epoch 20 | Train loss: 0.00634 | Val loss: 0.00836 | Combo score: 0.478 | Smoothed: 0.457 | MCC: 0.358 | REC: 0.444 | PRE: 0.400 | AUC: 0.786 | Threshold: 0.02052
Epoch 21 | Train loss: 0.00611 | Val loss: 0.00825 | Combo score: 0.478 | Smoothed: 0.459 | MCC: 0.358 | REC: 0.415 | PRE: 0.421 | AUC: 0.785 | Threshold: 0.02198
Epoch 22 | Train loss: 0.00596 | Val loss: 0.00808 | Combo score: 0.479 | Smoothed: 0.461 | MCC: 0.360 | REC: 0.444 | PRE: 0.403 | AUC: 0.788 | Threshold: 0.01982
Epoch 23 | Train loss: 0.00569 | Val loss: 0.00795 | Combo score: 0.470 | Smoothed: 0.462 | MCC: 0.337 | REC: 0.430 | PRE: 0.379 | AUC: 0.781 | Threshold: 0.01994
Epoch 24 | Train loss: 0.00569 | Val loss: 0.00806 | Combo score: 0.481 | Smoothed: 0.464 | MCC: 0.361 | REC: 0.433 | PRE: 0.412 | AUC: 0.801 | Threshold: 0.01996
Early stopping at epoch 24 (no improvement in smoothed or combo score over 10 epochs)

--- Fold 11 summary (years: [2015, 2016]) ---
Best epoch: 5
Threshold used: 0.01999
Validation metrics:
ACC: 78.3%
PRE: 27.7%
REC: 80.7%
MCC: 0.39
AUC: 0.83
==================================================

